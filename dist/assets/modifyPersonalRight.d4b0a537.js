import{r as n,q as S,e as y,o as u,c as k,a as l,F as $,d as q,u as d,t as b,w as B,v as I,s as x,l as T,f as H,x as A,m as N}from"./index.0a0d1aee.js";import{u as P}from"./Article.979dd6f7.js";import{_ as V}from"./_plugin-vue_export-helper.cdc0426e.js";import"./iconmonstr-user-5-240.bf901f19.js";const F={class:"container"},Q={class:"content"},R={class:"article-left"},O={class:"user"},U=["src"],J={class:"article-user"},j=["readonly","onUpdate:modelValue"],z={class:"article-right"},G=["onClick"],K=["onClick"],W={class:"message"},X={__name:"modifyPersonalRight",setup(Y){const _=n(!0),m=n("");let v=n(0),s=n([]),g=!1,w=!1;const r=n([]),C=n([]),h=P(),D=()=>{const e=document.body.scrollHeight,o=document.body.scrollTop||document.documentElement.scrollTop,a=document.documentElement.clientHeight;e-o-a<=100&&E()},E=async()=>{g||w||(console.log("\u52A0\u8F09\u4E86"),g=!0,v.value+=10,await y.post("/member/personalListQuest",{article:v.value}).then(e=>{console.log(v.value),console.log(e.data.questData.length),s.value=s.value.concat(e.data.questData),console.log(s.value.length),console.log(s.value),r.value=[],s.value.forEach(o=>{r.value.push([o.content])}),e.data.questData.length<10&&(w=!0)}),g=!1,console.log("false"))};function L(e){h.deleteArticle(e),setTimeout(()=>{window.location.reload()},50)}const M=async(e,o,a)=>{if(_.value=!_.value,m.value[o].innerHTML="\u4FDD\u5B58",_.value===!0){m.value[o].innerHTML="\u4FEE\u6539";let t={id:e,content:a};console.log(t),await y.post("/member/updateQuestById",t).then(c=>{console.log(c)})}};let f=n(!1),p=n(!1);return S(()=>{JSON.parse(localStorage.getItem("login"))===0?(f.value=!0,p.value=!1,console.log("\u6703\u54E1")):(p.value=!0,f.value=!1,console.log("\u7BA1\u7406")),y.post("/member/personalListQuest",{article:v.value}).then(o=>{s.value=s.value.concat(o.data.questData),s.value.forEach(a=>{r.value.push([a.content]),C.value.push("data:image/png;base64,"+a.profilePicture)})}),window.addEventListener("scroll",D)}),(e,o)=>{const a=N("router-link");return u(),k("div",F,[l("ul",Q,[(u(!0),k($,null,q(d(s),(t,c)=>(u(),k("li",{key:c},[l("div",R,[l("div",O,[l("img",{src:C.value[0],alt:"",class:"img"},null,8,U),l("span",J,b(t.author),1)]),B(l("textarea",{class:"article-content",rows:"4",readonly:_.value,"onUpdate:modelValue":i=>r.value[c]=i},null,8,j),[[I,r.value[c]]]),d(f)?(u(),x(a,{key:0,to:"/modifypersoSeeArticle",onClick:i=>d(h).browseArticles(t),class:"articleItem"},{default:T(()=>[H(" \u5B8C\u6574\u95B1\u8B80 ")]),_:2},1032,["onClick"])):A("",!0),d(p)?(u(),x(a,{key:1,to:"/managerPage/FullArticle",onClick:i=>d(h).browseArticles(t),class:"articleItem"},{default:T(()=>[H(" \u5B8C\u6574\u95B1\u8B80 ")]),_:2},1032,["onClick"])):A("",!0)]),l("div",z,[l("button",{class:"message",onClick:i=>M(t.id,c,r.value[c]),ref_for:!0,ref_key:"$change",ref:m},"\u4FEE\u6539",8,G),l("button",{class:"delete",onClick:i=>L(t)},"\u522A\u9664",8,K),l("div",W,"\u7559\u8A00\u6578:"+b(t.messageNum),1)])]))),128))])])}}},se=V(X,[["__scopeId","data-v-7e495271"]]);export{se as default};
